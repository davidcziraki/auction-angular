<div class="filter-tabs">
  <p-button
    (click)="filterStatus('all')"
    [severity]="selectedFilter === 'all' ? 'primary' : 'secondary'"
    label="All">
  </p-button>

  <p-button
    (click)="filterStatus('active')"
    [severity]="selectedFilter === 'active' ? 'info' : 'secondary'"
    label="Active">
  </p-button>

  <p-button
    (click)="filterStatus('expired')"
    [severity]="selectedFilter === 'expired' ? 'warn' : 'secondary'"
    label="Expired">
  </p-button>

  <p-button
    (click)="filterStatus('completed')"
    [severity]="selectedFilter === 'completed' ? 'success' : 'secondary'"
    label="Complete">
  </p-button>

  <!-- Add Auction Button (Aligned to the Right) -->
  <p-button
    (click)="openNewAuctionDialog()"
    icon="pi pi-plus"
    label="New Auction"
    severity="primary"
  >
  </p-button>
</div>

<!-- New Auction Dialog -->
<p-dialog
  [(visible)]="newAuctionDialog"
  [contentStyle]="{height: '1000px', overflow: 'auto'}"
  [dismissableMask]="true"
  [modal]="true"
  [style]="{width: '1200px', height: '1000px'}"

  header="Create New Auction">


  <div class="p-fluid p-formgrid p-grid">

    <!-- Car Title -->
    <div class="p-field p-col-12 p-md-6">
      <label for="year">Year</label>
      <input [(ngModel)]="newAuction.year" id="year" pInputText required/>
    </div>

    <!-- Car Title -->
    <div class="p-field p-col-12 p-md-6">
      <label for="make">Make</label>
      <input [(ngModel)]="newAuction.make" id="make" pInputText required/>
    </div>

    <!-- Car Title -->
    <div class="p-field p-col-12 p-md-6">
      <label for="model">Model</label>
      <input [(ngModel)]="newAuction.model" id="model" pInputText required/>
    </div>

    <!-- Seller -->
    <div class="p-field p-col-12 p-md-6">
      <label for="seller">Seller</label>
      <input [(ngModel)]="newAuction.seller" id="seller" pInputText required/>
    </div>

    <!-- End Date -->
    <div class="p-field p-col-12 p-md-6">
      <label for="endtime">End Date</label>
      <p-datePicker
        [(ngModel)]="newAuction.endTimeDate"
        [showIcon]="true"
        [showTime]="true"
        class="form-control"
        dateFormat="dd MM yy"
        hourFormat="24"
        id="endtime"
        required>
      </p-datePicker>
    </div>

    <!-- Starting Price -->
    <div class="p-field p-col-12 p-md-6">
      <label for="price">Starting Price (HUF)</label>
      <input [(ngModel)]="newAuction.price" id="price" pInputText required type="number"/>
    </div>

    <!-- Image Upload -->
    <div class="p-field p-col-12">
      <label>Upload Car Image</label>
      <!--      <p-fileupload-->
      <!--        (onSelect)="onImageSelected($event)"-->
      <!--        accept="image/*"-->
      <!--        maxFileSize="2000000"-->
      <!--        mode="basic"-->
      <!--        name="image">-->
      <!--      </p-fileupload>-->

      <p-fileupload #fu
                    (onSelect)="onImageSelected($event)"
                    accept="image/*"
                    chooseIcon="pi pi-upload"
                    chooseLabel="Choose"
                    maxFileSize="1000000"
                    mode="basic"
                    name="image">
      </p-fileupload>


    </div>

  </div>

  <!-- Footer Buttons -->
  <ng-template pTemplate="footer">
    <div class="p-d-flex p-jc-end">
      <p-button
        (click)="newAuctionDialog = false"
        class="p-mr-2"
        icon="pi pi-times"
        label="Cancel"
        severity="secondary">
      </p-button>
      <p-button
        (click)="createAuction()"
        icon="pi pi-check"
        label="Create"

        severity="success">
      </p-button>
    </div>
  </ng-template>

</p-dialog>


<div class="grid-container">
  <ag-grid-angular
    [columnDefs]="colDefs"
    [context]="this"
    [paginationPageSizeSelector]="paginationPageSizeSelector"
    [paginationPageSize]="paginationPageSize"
    [pagination]="true"
    [rowData]="filteredAuctions"
    [theme]="newTheme"
    style="width: 100%; height: 100%; text-align: center"
  >

  </ag-grid-angular>
</div>


<!-- Edit Modal -->
<p-dialog [(visible)]="displayEditModal" [closable]="true" [style]="{width: '1200px', height: '1000px'}"
          header="Edit Auction"

          modal="true">
  <div *ngIf="selectedAuction">

    <!-- Car Title -->
    <label>Year:</label>
    <input [(ngModel)]="selectedAuction.year" class="form-control" type="text"/>

    <label>Make:</label>
    <input [(ngModel)]="selectedAuction.make" class="form-control" type="text"/>

    <label>Model:</label>
    <input [(ngModel)]="selectedAuction.model" class="form-control" type="text"/>

    <!-- Seller -->
    <label>Seller:</label>
    <input [(ngModel)]="selectedAuction.seller" class="form-control" type="text"/>

    <!-- End Date -->
    <label>End Date:</label>
    <p-datePicker
      [(ngModel)]="selectedAuction.endTimeDate"
      [showIcon]="true"
      [showTime]="true"
      class="form-control"
      dateFormat="dd MM yy"
      hourFormat="24">
    </p-datePicker>

    <!-- Starting Price -->
    <label>Starting Price (HUF):</label>
    <input [(ngModel)]="selectedAuction.price" class="form-control" type="number"/>

    <!-- Upload New Image -->
    <label>Upload New Image:</label>
    <p-fileupload
      (onSelect)="onImageSelected($event)"
      [auto]="false"
      accept="image/*"
      chooseLabel="Change Image"
      mode="basic"
      name="auctionImage">
    </p-fileupload>

    <!-- Footer Buttons -->
    <div class="modal-footer">
      <button (click)="updateAuction()" class="btn btn-primary">Save Changes</button>
      <button (click)="displayEditModal = false" class="btn btn-secondary">Cancel</button>
    </div>

  </div>
</p-dialog>
