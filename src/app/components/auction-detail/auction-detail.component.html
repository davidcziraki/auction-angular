<!-- Main auction header bar -->
<div class="auction-bar">
  <!-- Back Button -->
  <button [routerLink]="['/search']" class="back-button" icon="pi pi-chevron-left" pButton></button>

  <!-- Main Auction Info -->
  <div class="auction-info main">
<!--    <h1 class="vehicle-title">{{ auction?.year }} {{ auction?.make }} {{ auction?.model }}</h1>-->
  </div>


  <!-- Countdown Timer -->
  <div class="auction-info">
    <span class="countdown">{{ auction?.countdown }}</span>
    <div class="label">{{ auction?.endTimeDate | date: 'MMM d h:mm a' }}</div>
  </div>

  <!-- Bids Count -->
  <div class="auction-info">
    <span class="bids">{{ bids }}</span>
    <div class="label">BIDS</div>
  </div>

  <!-- Action Buttons -->
  <div class="actions">
    <button (click)="toggleFavourite(auction)" class="watch-button" pButton>
      <i [ngClass]="auction?.isFavourite ? 'pi pi-heart-fill' : 'pi pi-heart'"></i>
      WATCH
    </button>

    <button (click)="openShareModal()" class="share-button" pButton>
      <i class="pi pi-share-alt"></i>
      SHARE
    </button>
    <button (click)="openCalendarModal()" class="calendar-button" pButton>
      <i class="pi pi-calendar-plus"></i>
    </button>
  </div>

</div>

<!-- Main content container -->
<div class="auction-container">
  <!-- Left side - gallery -->
  <div class="gallery-container">
    <p-galleria
      [containerStyle]="{ 'max-width': '100%', 'border-radius': '8px', 'overflow': 'hidden' }"
      [numVisible]="5"
      [responsiveOptions]="responsiveOptions"
      [showItemNavigators]="true"
      [value]="images"
      class="main-gallery"
    >
      <ng-template #item let-item>
        <img [src]="item.itemImageSrc" style="width:100%; height:100%; object-fit:cover;"/>
      </ng-template>
      <ng-template #thumbnail let-item>
        <img [src]="item.thumbnailImageSrc" style="width:100%; height:100%; object-fit:cover;"/>
      </ng-template>
    </p-galleria>
  </div>

  <!-- Right side - details -->
  <div class="details-container">
    <div class="vehicle-header">
      <h1 class="vehicle-title">{{ auction?.year }} {{ auction?.make }} {{ auction?.model }}</h1>
      <div class="auction-status">Ends: {{ auction?.endTimeDate | date: 'MMM d h:mm a' }}</div>
    </div>

    <!-- Features/Specs grid -->
    <div class="features-container">
      <div class="feature-card">
        <img alt="Calendar Icon" class="feature-icon" src="icons/calendar.png"/>
        <div class="feature-text">{{ auction?.year }}</div>
      </div>
      <div class="feature-card">
        <img alt="Speedometer Icon" class="feature-icon" src="icons/speedometer.png"/>
        <div class="feature-text">{{ auction?.mileage | number }} miles</div>
      </div>
      <div class="feature-card">
        <img alt="Transmission Icon" class="feature-icon" src="icons/transmission.png"/>
        <div class="feature-text">{{ auction?.transmission }}</div>
      </div>
      <div class="feature-card">
        <img alt="Engine Icon" class="feature-icon" src="icons/engine.png"/>
        <div class="feature-text">3 ltr</div>
      </div>
      <div class="feature-card">
        <img alt="Colour Icon" class="feature-icon" src="icons/colour.png"/>
        <div class="feature-text">{{ auction?.colour }}</div>
      </div>
      <div class="feature-card">
        <img alt="Fuel Icon" class="feature-icon" src="icons/fuel.png"/>
        <div class="feature-text">{{ auction?.fuel }}</div>
      </div>
    </div>

    <!-- Bid section -->
    <div class="bid-section">
      <div class="current-bid">
        <div class="bid-amount">HUF {{ (auction$ | async)?.price | number }}</div>
        <div class="bid-count">CURRENT BID</div>
      </div>

      <div class="bidding-form" *ngIf="biddingSectionVisible">
        <label for="bidAmount">Your Bid Amount</label>
        <input [(ngModel)]="bidAmount"
               [min]="minBid" id="bidAmount" pInputText
               placeholder="Enter your bid" step="1"
               type="number" pattern="\d*">

        <small *ngIf="bidError" class="error-text">{{ bidError }}</small>
      </div>

      <button (click)="toggleBiddingSection()"
              [disabled]="!canPlaceBid && !biddingSectionVisible"
              class="place-bid-button" pButton pRipple>
        <i class="pi pi-check"></i> {{ biddingSectionVisible ? 'Place Bid' : 'Open Bidding' }}
      </button>
    </div>




  </div>

<!-- Toast notification -->
<p-toast class="custom-toast"></p-toast>


<!-- SHARE MODAL -->
<p-dialog [(visible)]="displayShareDialog" [closable]="true" [header]="'Share Auction'" [modal]="true"
          class="share-modal">
  <div class="share-modal-container">
    <p>Copy and share this auction link:</p>

    <div class="share-input-container">
      <input [(ngModel)]="shareLink" pInputText readonly type="text">
      <button (click)="copyToClipboard()" class="copy-button" pButton>
        <i class="pi pi-copy"></i> Copy
      </button>
    </div>

    <p class="share-text">Or share on:</p>
    <div class="social-buttons">
      <button (click)="shareOnFacebook()" class="facebook-button" pButton>
        <i class="pi pi-facebook"></i> Facebook
      </button>
      <button (click)="shareOnTwitter()" class="twitter-button" pButton>
        <i class="pi pi-twitter"></i> Twitter
      </button>
      <button (click)="shareOnWhatsApp()" class="whatsapp-button" pButton>
        <i class="pi pi-whatsapp"></i> WhatsApp
      </button>
    </div>
  </div>
</p-dialog>

<!-- CALENDAR MODAL -->
<p-dialog [(visible)]="displayCalendarDialog" [closable]="true" [header]="'Add to Calendar'" [modal]="true">
  <div class="calendar-modal-container">
    <p>Choose where to add this auction to your calendar:</p>

    <div class="calendar-buttons">
      <button (click)="addToGoogleCalendar()" class="calendar-button google" pButton>
        <i class="pi pi-google"></i> Google Calendar
      </button>

      <button (click)="addToOutlookCalendar()" class="calendar-button outlook" pButton>
        <i class="pi pi-calendar"></i> Outlook / Apple Calendar
      </button>

      <button (click)="addToCalendar()" class="calendar-button ics" pButton>
        <i class="pi pi-download"></i> Download .ICS File
      </button>
    </div>
  </div>
</p-dialog>
