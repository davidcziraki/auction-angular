<div class="auction-bar">
  <!-- Back Button -->
  <button [routerLink]="['/search']" class="back-button" icon="pi pi-chevron-left" pButton></button>

  <!-- Current Bid -->
  <div class="auction-info">
    <div class="price">
      <span class="currency">HUF </span>
      <span class="amount">{{ (auction$ | async)?.price | number }}</span>
    </div>
    <div class="label">CURRENT BID</div>
  </div>

  <!-- Countdown Timer -->
  <div class="auction-info">
    <span class="countdown">{{ auction?.countdown }}</span>
    <div class="label">{{ auction?.endTimeDate | date: 'MMM d h:mm a' }}</div>
  </div>

  <!-- Bids Count -->
  <div class="auction-info">
    <span class="bids">{{ bids }}</span>
    <div class="label">BIDS</div>
  </div>

  <!-- Action Buttons -->
  <div class="actions">
    <button (click)="toggleFavourite(auction)" class="watch-button" pButton>
      <i [ngClass]="auction?.isFavourite ? 'pi pi-heart-fill' : 'pi pi-heart'"></i>
      WATCH
    </button>

    <button (click)="openShareModal()" class="share-button" pButton>
      <i class="pi pi-share-alt"></i>
      SHARE
    </button>
    <button (click)="openCalendarModal()" class="calendar-button" pButton>
      <i class="pi pi-calendar-plus"></i>
    </button>
  </div>


  <!-- Place Bid Button -->
  <button (click)="openBidding()" label="PLACE BID" pButton pRipple></button>
</div>


<div class="gallery">
  <div class="main-image">
    <img [src]="mainImage" alt="">
  </div>
  <div class="thumbnail-images">
    <div *ngFor="let image of thumbnailImages; let i = index" class="thumbnail">
      <img [src]="image" alt="Thumbnail {{i + 1}}">
    </div>
  </div>
</div>


<p-toast class="custom-toast"></p-toast>


<!--&lt;!&ndash; BIDDING MODAL &ndash;&gt;-->
<!--<div *ngIf="displayBidDialog">-->
<!--  <p-dialog [(visible)]="displayBidDialog" [closable]="true" [modal]="true" [ngClass]="'bidding-modal'">-->
<!--    <div class="bidding-modal-container">-->
<!--      <div class="bidding-modal-header">-->
<!--        <div class="title">Place Your Bid</div>-->
<!--        <span class="current-bid">-->
<!--          Current Highest Bid: HUF <strong>{{ (auction$ | async)?.price | number }}</strong>-->
<!--        </span>-->
<!--      </div>-->

<!--      &lt;!&ndash; Bidding Form &ndash;&gt;-->
<!--      <div class="bidding-modal-form">-->
<!--        <label for="bidAmount">Your Bid Amount</label>-->
<!--        <input [(ngModel)]="bidAmount" id="bidAmount" min="{{ auction?.price }}" pInputText-->
<!--               placeholder="Enter your bid" type="number">-->
<!--      </div>-->

<!--      <button (click)="placeBid()" class="bidding-modal-button" icon="pi pi-check" label="Place Bid" pButton pRipple>-->
<!--      </button>-->
<!--    </div>-->
<!--  </p-dialog>-->
<!--</div>-->

<!-- BIDDING MODAL -->
<div *ngIf="displayBidDialog">
  <p-dialog [(visible)]="displayBidDialog" [closable]="true" [modal]="true" [ngClass]="'bidding-modal'">
    <div class="bidding-modal-container">

      <!-- Header Section -->
      <div class="bidding-modal-header">
        <h2 class="title">Place Your Bid</h2>
        <span class="current-bid">
          Current Highest Bid: <strong>HUF {{ (auction$ | async)?.price | number }}</strong>
        </span>
      </div>

      <!-- Bidding Form -->
      <div class="bidding-modal-form">
        <label for="bidAmount">Your Bid Amount</label>
        <input (input)="validateBid()" [(ngModel)]="bidAmount"
               [min]="minBid" id="bidAmount" pInputText
               placeholder="Enter your bid" step="1"
               type="number">

        <small *ngIf="bidError" class="error-text">{{ bidError }}</small>
      </div>

      <!-- Buttons -->
      <div class="bidding-modal-actions">
        <button (click)="placeBid()" [disabled]="!canPlaceBid"
                class="bidding-modal-button" pButton pRipple>
          <i class="pi pi-check"></i> Place Bid
        </button>
      </div>

    </div>
  </p-dialog>
</div>


<!-- SHARE MODAL -->
<p-dialog [(visible)]="displayShareDialog" [closable]="true" [header]="'Share Auction'" [modal]="true"
          class="share-modal">
  <div class="share-modal-container">
    <p>Copy and share this auction link:</p>

    <div class="share-input-container">
      <input [(ngModel)]="shareLink" pInputText readonly type="text">
      <button (click)="copyToClipboard()" class="copy-button" pButton>
        <i class="pi pi-copy"></i> Copy
      </button>
    </div>

    <p class="share-text">Or share on:</p>
    <div class="social-buttons">
      <button (click)="shareOnFacebook()" class="facebook-button" pButton>
        <i class="pi pi-facebook"></i> Facebook
      </button>
      <button (click)="shareOnTwitter()" class="twitter-button" pButton>
        <i class="pi pi-twitter"></i> Twitter
      </button>
      <button (click)="shareOnWhatsApp()" class="whatsapp-button" pButton>
        <i class="pi pi-whatsapp"></i> WhatsApp
      </button>
    </div>
  </div>
</p-dialog>


<!-- CALENDAR MODAL -->
<p-dialog [(visible)]="displayCalendarDialog" [closable]="true" [header]="'Add to Calendar'" [modal]="true">
  <div class="calendar-modal-container">
    <p>Choose where to add this auction to your calendar:</p>

    <div class="calendar-buttons">
      <button (click)="addToGoogleCalendar()" class="calendar-button google" pButton>
        <i class="pi pi-google"></i> Google Calendar
      </button>

      <button (click)="addToOutlookCalendar()" class="calendar-button outlook" pButton>
        <i class="pi pi-calendar"></i> Outlook / Apple Calendar
      </button>

      <button (click)="addToCalendar()" class="calendar-button ics" pButton>
        <i class="pi pi-download"></i> Download .ICS File
      </button>
    </div>
  </div>
</p-dialog>



